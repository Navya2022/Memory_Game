<!DOCTYPE html>
<html>
<head>
    <title>Display Input Data</title>
    <link rel="stylesheet" href="style1.css">
</head>
<body>


    <div id="inputContainer">
    <div class="qa-field">
        
    </div>
    </div>

    <button id="addBtn"x>+</button> 


<script>
    async function displayData() {
    let questions = [];
    let answers = [];

    const fields = document.querySelectorAll(".qa-field");

    const toBase64 = file => new Promise(resolve => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.readAsDataURL(file);
    });

    for (let field of fields) {

        const qRadio = field.querySelector('input[name^="qtype"]:checked');
        const qIsImage = qRadio?.value === "image";

        let qValue;
        if (qIsImage) {
            const file = field.querySelector(".question-image")?.files?.[0];
            qValue = file ? await toBase64(file) : null;
        } else {
            qValue = field.querySelector(".question-input")?.value?.trim() || null;
        }

        const aRadio = field.querySelector('input[name^="atype"]:checked');
        const aIsImage = aRadio?.value === "image";

        let aValue;
        if (aIsImage) {
            const file = field.querySelector(".answer-image")?.files?.[0];
            aValue = file ? await toBase64(file) : null;
        } else {
            aValue = field.querySelector(".answer-input")?.value?.trim() || null;
        }

        if (qValue && aValue) {
    questions.push({
        type: qIsImage ? "image" : "text",
        content: qValue
    });

    answers.push({
        type: aIsImage ? "image" : "text",
        content: aValue
    });
}

    }

    localStorage.setItem("flashcards", JSON.stringify({ questions, answers }));
    window.location.href = "card_game.html";
}

</script>
<script>
    function createQAField() {
    const div = document.createElement("div");
    div.classList.add("qa-field");

    const uniqueID = Date.now();

    div.innerHTML = `
        <div class="question-block">
            <label><b>Question</b></label><br>

            <label>Text <input type="radio" name="qtype-${uniqueID}" value="text" checked></label>
            <label>Image <input type="radio" name="qtype-${uniqueID}" value="image"></label>
            <div class="question-input-container">
                <input type="text" class="question-input" placeholder="Enter question">
            </div>
        </div>
        <br>

        <div class="answer-block">
            <label><b>Answer</b></label><br>

            <label>Text <input type="radio" name="atype-${uniqueID}" value="text" checked></label>
            <label>Image <input type="radio" name="atype-${uniqueID}" value="image"></label>
            <div class="answer-input-container">
                <input type="text" class="answer-input" placeholder="Enter answer">
            </div>
        </div>

        <button class="deleteBtn">âˆ’</button>
    `;

    div.querySelector(".deleteBtn").addEventListener("click", () => div.remove());

    div.querySelectorAll(`input[name="qtype-${uniqueID}"]`).forEach(radio => {
        radio.addEventListener("change", e => {
            const container = div.querySelector(".question-input-container");
            if (e.target.value === "text") {
                container.innerHTML = `<input type="text" class="question-input" placeholder="Enter question">`;
            } else {
                container.innerHTML = `<input type="file" accept="image/*" class="question-image">`;
            }
        });
    });

    div.querySelectorAll(`input[name="atype-${uniqueID}"]`).forEach(radio => {
        radio.addEventListener("change", e => {
            const container = div.querySelector(".answer-input-container");
            if (e.target.value === "text") {
                container.innerHTML = `<input type="text" class="answer-input" placeholder="Enter answer">`;
            } else {
                container.innerHTML = `<input type="file" accept="image/*" class="answer-image">`;
            }
        });
    });

    return div;
}


    document.getElementById("addBtn").addEventListener("click", () => {
        document.getElementById("inputContainer").appendChild(createQAField());
    });

    document.querySelector(".deleteBtn").addEventListener("click", (e) => {
        e.target.parentElement.remove();
    });
    document.querySelectorAll(".type-radio").forEach(radio => {
    radio.addEventListener("change", function() {
        const parent = this.closest(".qa-field");
        parent.classList.remove("radio_text", "radio_image");
        parent.classList.add("radio_" + this.value.toLowerCase());
    });
});
</script>

<button id = "generate_button" onclick="displayData()">Generate Cards</button>

</body>
</body>
</html>
